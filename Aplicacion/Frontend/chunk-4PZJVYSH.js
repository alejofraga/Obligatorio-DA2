import{a as oe}from"./chunk-MO7ZBCZV.js";import{a as P}from"./chunk-B4MY55FY.js";import{a as re,b as B,c as q,d as Ae}from"./chunk-VER4IG53.js";import{a as Ne}from"./chunk-BZ2FDTJU.js";import{$ as Y,A as a,Aa as G,B as s,Ba as F,C as l,F as Fe,G as u,H as g,I as h,K as d,R as K,S as X,X as _e,Y as M,_ as Oe,a as U,b as Ce,c as Z,e as Me,ea as Re,f as j,fa as xe,ga as Pe,h as E,j as T,ja as ye,k as Q,ka as ee,l as $,la as te,m as f,ma as y,n as J,na as je,p as Ie,pa as R,q as He,ra as O,sa as C,t as n,u as p,ua as Ee,v as w,x as i,xa as H,ya as Te,z as S,za as x}from"./chunk-EPVYEA6G.js";var ie=class o extends te{constructor(e){super(ee.apiUrl,"homes",e);this.http=e}addMember(e,t){return this.patch(t,`/${e}/members`)}getMembers(e,t){return this.get(`/${e}/members`,t)}addHardware(e,t){return this.patch(t,`/${e}/hardwares`)}getHardwares(e,t){return this.get(`/${e}/hardwares`,t)}grantPermissions(e,t){return this.patch(t,`/${e}/permissions`)}getMemberPermissions(e,t){return this.get(`/${e}/members/permissions`,t)}userIsTheHomeOwner(e){return this.get(`/${e}/owner`)}addRoom(e,t){return this.post(t,`/${e}/rooms`)}getRooms(e){return this.get(`/${e}/rooms`)}changeHomeName(e,t){return this.patch(t,`/${e}/name`)}static \u0275fac=function(t){return new(t||o)($(Y))};static \u0275prov=T({token:o,factory:o.\u0275fac,providedIn:"root"})};var v=class o{constructor(r){this.homeRepository=r}addMember(r,e){return this.homeRepository.addMember(r,e).pipe(E(t=>(t.status===0&&console.error("No se pudo establecer la conexi\xF3n con el servidor"),j(t))))}getMembers(r,e){return this.homeRepository.getMembers(r,e).pipe(E(t=>(t.status===0&&console.error("No se pudo establecer la conexi\xF3n con el servidor"),j(t))))}addHardware(r,e){return this.homeRepository.addHardware(r,e).pipe(E(t=>(t.status===0&&console.error("No se pudo establecer la conexi\xF3n con el servidor"),j(t))))}getHardwares(r,e){return this.homeRepository.getHardwares(r,e).pipe(E(t=>(t.status===0&&console.error("No se pudo establecer la conexi\xF3n con el servidor"),j(t))))}grantPermissions(r,e){return this.homeRepository.grantPermissions(r,e).pipe(E(t=>(t.status===0&&console.error("No se pudo establecer la conexi\xF3n con el servidor"),j(t))))}getMemberPermissions(r){return this.homeRepository.getMemberPermissions(r).pipe(E(e=>(e.status===0&&console.error("No se pudo establecer la conexi\xF3n con el servidor"),j(e))))}addRoom(r,e){return this.homeRepository.addRoom(r,e).pipe(E(t=>(t.status===0&&console.error("No se pudo establecer la conexi\xF3n con el servidor"),j(t))))}userIsTheHomeOwner(r){return this.homeRepository.userIsTheHomeOwner(r).pipe(E(e=>(e.status===0&&console.error("No se pudo establecer la conexi\xF3n con el servidor"),j(e))))}getRooms(r){return this.homeRepository.getRooms(r).pipe(E(e=>(e.status===0&&console.error("No se pudo establecer la conexi\xF3n con el servidor"),j(e))))}changeHomeName(r,e){return this.homeRepository.changeHomeName(r,e)}static \u0275fac=function(e){return new(e||o)($(ie))};static \u0275prov=T({token:o,factory:o.\u0275fac,providedIn:"root"})};var b=class o{homeIdSource=new Me(null);homeId$=this.homeIdSource.asObservable();validHomePermissions=["AddDevice","ChangeHomeName","GrantHomePermissions","ListDevices","ReceiveNotifications","ChangeDeviceName","AddDeviceToRoom"];setHomeId(r){this.homeIdSource.next(r)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=T({token:o,factory:o.\u0275fac,providedIn:"root"})};function ke(o,r){if(o&1){let e=Fe();a(0,"div",10)(1,"app-checkbox",11),u("checkedChange",function(m){let c,_=Ie(e).$implicit,$e=g();return He((c=$e.grantPermissionsForm.get(_))==null?null:c.setValue(m))}),s()()}if(o&2){let e,t,m=r.$implicit,c=g();n(),i("label",c.camelCaseToSpaces(m))("checked",(e=c.grantPermissionsForm.get(m))==null?null:e.value)("disabled",(t=(t=c.grantPermissionsForm.get(m))==null?null:t.disabled)!==null&&t!==void 0?t:!1)}}var ne=class o{constructor(r,e,t,m){this.homeService=r;this.homeManagementService=e;this.fb=t;this.loadingService=m}homeId;membersHomePermissions=[];members=[];selectedMemberPermissions={};homePermissions=[];grantPermissionsForm;formField={members:{name:"members",options:this.members,required:"Device type is required",class:"form-select"}};ngOnInit(){this.homeManagementService.homeId$.subscribe(r=>{r&&(this.homeId=r)}),this.homePermissions=this.homeManagementService.validHomePermissions,this.initializeForm(),this.fetchMembersOnInit(this.homeId)}initializeForm(){let r={};this.homePermissions.forEach(e=>{r[e]=new C(!1)}),this.grantPermissionsForm=this.fb.group(U({members:new C("")},r))}fetchMembersOnInit(r){this.loadingService.show(),this.homeService.getMembers(r).subscribe({next:e=>{this.loadingService.hide();let t=e.data.map(c=>({email:c.email,permissions:c.homePermissions})),m=e.data.map(c=>({value:c.email,label:c.email}));this.membersHomePermissions=t,this.members=m,this.grantPermissionsForm.get(this.formField.members.name)?.setValue(this.members[0].value),this.formField.members.options=this.members,this.disableMembersPermissions(this.members[0].value)},error:e=>{this.loadingService.hide(),console.error("Error fetching members:",e)}})}onSubmit(){if(!this.grantPermissionsForm.valid)return;let r=[];this.homePermissions.forEach(t=>{let m=this.grantPermissionsForm.get(t);m?.value&&!m.disabled&&r.push(t)});let e={MemberEmail:this.grantPermissionsForm.get("members")?.value,HomePermissions:r};this.homeService.grantPermissions(this.homeId,e).subscribe({next:t=>{this.loadMembers(this.homeId,e.MemberEmail)},error:t=>{console.error("Error granting permissions:",t)}})}onSelectChange=r=>{this.homePermissions.forEach(e=>{this.grantPermissionsForm.get(e)?.setValue(!1),this.grantPermissionsForm.get(e)?.enable()}),this.grantPermissionsForm.get(this.formField.members.name)?.setValue(r),this.disableMembersPermissions(r)};disableMembersPermissions(r){this.homePermissions.forEach(e=>{this.membersHomePermissions.find(t=>t.email===r)?.permissions.includes(e)?(this.grantPermissionsForm.get(e)?.setValue(!0),this.grantPermissionsForm.get(e)?.disable()):(this.grantPermissionsForm.get(e)?.setValue(!1),this.grantPermissionsForm.get(e)?.enable())}),this.selectedMemberPermissions={}}loadMembers(r,e){this.homeService.getMembers(r).subscribe({next:t=>{let m=t.data.map(_=>({email:_.email,permissions:_.homePermissions})),c=t.data.map(_=>({value:_.email,label:_.email}));this.membersHomePermissions=m,this.members=c,this.formField.members.options=this.members,this.disableMembersPermissions(e)}})}camelCaseToSpaces=r=>{let e=r.replace(/([a-z])([A-Z])/g,"$1 $2");return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()};static \u0275fac=function(e){return new(e||o)(p(v),p(b),p(Ee),p(y))};static \u0275cmp=f({type:o,selectors:[["app-grant-permissions"]],decls:11,vars:6,consts:[[1,"d-flex","justify-content-center"],[1,"container","p-4","shadow","rounded","bg-white",2,"max-width","700px"],[1,"text-center","mb-4","text-primary"],[1,"w-100",3,"ngSubmit","form"],[1,"mb-3"],["label","Members",3,"selectedValueChange","options","selectedValue"],[1,"row","w-70","justify-content-center"],["class","mt-3 col-lg-4",4,"ngFor","ngForOf"],[1,"mt-4","text-center"],["title","Submit",1,"btn","btn-primary","w-100"],[1,"mt-3","col-lg-4"],[3,"checkedChange","label","checked","disabled"]],template:function(e,t){if(e&1&&(a(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"Grant Permissions"),s(),a(4,"app-form",3),u("ngSubmit",function(){return t.onSubmit()}),a(5,"div",4)(6,"app-select",5),u("selectedValueChange",function(c){return t.onSelectChange(c)}),s()(),a(7,"div",6),w(8,ke,2,3,"div",7),s(),a(9,"div",8),l(10,"app-form-button",9),s()()()()),e&2){let m;n(4),i("form",t.grantPermissionsForm),n(2),S("form-select"),i("options",t.members)("selectedValue",(m=t.grantPermissionsForm.get("members"))==null?null:m.value),n(2),i("ngForOf",t.homePermissions)}},dependencies:[_e,H,G,oe,P]})};function Be(o,r){if(o&1&&l(0,"app-sidebar",4),o&2){let e=g();i("items",e.sideBarItems)}}var se=class o{constructor(r,e,t,m,c,_){this.route=r;this.router=e;this.homeService=t;this.authService=m;this.homeManagementService=c;this.loadingService=_}homeId;permissions=[];isHomeOwner=!1;sideBarItems=[{title:"Member",operations:this.permissions}];ngOnInit(){this.homeId=this.route.snapshot.paramMap.get("id")||"",this.homeManagementService.setHomeId(this.homeId),this.loadData().then(()=>{this.updateSideBarItems(),this.redirectBasedOnPermissions()})}loadData(){return Z(this,null,function*(){yield this.getPermissions(),yield this.isTheHomeOwner()})}isTheHomeOwner(){return Z(this,null,function*(){return new Promise((r,e)=>{this.loadingService.show(),this.homeService.userIsTheHomeOwner(this.homeId).subscribe({next:t=>{this.loadingService.hide(),this.isHomeOwner=t.data,r()},error:t=>{console.error(t),e(t)}})})})}getPermissions(){return Z(this,null,function*(){return new Promise((r,e)=>{this.loadingService.show(),this.homeService.getMemberPermissions(this.homeId).subscribe({next:t=>{this.loadingService.hide();let m=t.data;this.permissions=m.map(c=>c.replace(/([A-Z])/g," $1").trim()),this.permissions=this.permissions.filter(c=>!["Create Room","Receive Notifications"].includes(c)),r()},error:t=>{console.error(t),e(t)}})})})}updateSideBarItems(){this.sideBarItems=[...this.isHomeOwner?[{title:"Home Owner",operations:["Add Member","List Members","Create Room"]}]:[],...this.permissions.length>0?[{title:"Member",operations:this.permissions}]:[]]}redirectBasedOnPermissions(){this.permissions.length===0&&this.router.navigate(["welcome-no-permissions"],{relativeTo:this.route})}static \u0275fac=function(e){return new(e||o)(p(Re),p(Pe),p(v),p(Ne),p(b),p(y))};static \u0275cmp=f({type:o,selectors:[["app-home-managment-page"]],decls:5,vars:1,consts:[[1,"d-flex",2,"height","100vh"],["class","flex-shrink-0",3,"items",4,"ngIf"],[1,"flex-grow-1","d-flex","align-items-start","justify-content-center","p-4"],[1,"w-100",2,"max-width","1000px","margin-left","280px"],[1,"flex-shrink-0",3,"items"]],template:function(e,t){e&1&&(a(0,"div",0),w(1,Be,1,1,"app-sidebar",1),a(2,"div",2)(3,"div",3),l(4,"router-outlet"),s()()()),e&2&&(n(),i("ngIf",t.permissions.length>0))},dependencies:[M,xe,re],encapsulation:2})};var me=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=f({type:o,selectors:[["app-welcome-home-management-component"]],decls:1,vars:1,consts:[["imagePath","home-owner-welcome.png",3,"title"]],template:function(e,t){e&1&&l(0,"app-welcome",0),e&2&&i("title","Home Management")},dependencies:[B]})};function ze(o,r){if(o&1&&l(0,"app-information-alert",12),o&2){let e=g();i("message",e.successMessage)}}function Ue(o,r){if(o&1&&l(0,"app-information-alert",13),o&2){let e=g();i("message",e.errorMessage)}}var pe=class o{constructor(r,e,t){this.homeService=r;this.homeManagementService=e;this.loadingService=t}homeId;errorMessage="";successMessage="";addMemberForm;formField={email:{name:"email",required:"Email is required",class:"form-control"}};ngOnInit(){this.homeManagementService.homeId$.subscribe(r=>{r&&(this.homeId=r)}),this.addMemberForm=new O({[this.formField.email.name]:new C("",[R.required])})}onSubmit=r=>{if(!this.addMemberForm.valid)return;let e={UserEmail:r[this.formField.email.name]};this.loadingService.show(),this.homeService.addMember(this.homeId,e).subscribe({next:()=>{this.addMemberForm.reset(),this.loadingService.hide(),this.errorMessage="",this.successMessage="Member added successfully"},error:t=>{this.errorMessage=t.details,this.successMessage="",this.loadingService.hide()}})};createClass="btn btn-primary w-100 mt-3";static \u0275fac=function(e){return new(e||o)(p(v),p(b),p(y))};static \u0275cmp=f({type:o,selectors:[["app-add-member-component"]],decls:14,vars:12,consts:[[1,"d-flex","justify-content-center"],[1,"container","p-5","shadow","rounded","bg-white",2,"max-width","600px"],[1,"text-center","mb-4","text-primary"],[1,"w-100",3,"ngSubmit","form"],[1,"mb-3"],[1,"form-label","text-muted",3,"for"],["type","text","placeholder","example@smarthome.com",3,"id","name","form","formField"],[1,"text-center","mt-4","d-grid","gap-2"],["title","Create"],[1,"col-12","mt-3"],["type","success",3,"message",4,"ngIf"],["type","error",3,"message",4,"ngIf"],["type","success",3,"message"],["type","error",3,"message"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"Add Member"),s(),a(4,"app-form",3),u("ngSubmit",function(){return t.onSubmit(t.addMemberForm.value)}),a(5,"div",4)(6,"label",5),d(7,"Email"),s(),l(8,"app-form-input",6),s(),a(9,"div",7),l(10,"app-form-button",8),s(),a(11,"div",9),w(12,ze,1,1,"app-information-alert",10)(13,Ue,1,1,"app-information-alert",11),s()()()()),e&2&&(n(4),i("form",t.addMemberForm),n(2),h("for",t.formField.email.name),n(2),S(t.formField.email.class),h("id",t.formField.email.name),i("name",t.formField.email.name)("form",t.addMemberForm)("formField",t.formField),n(2),S("btn btn-primary btn-lg w-100"),n(2),i("ngIf",t.successMessage),n(),i("ngIf",t.errorMessage))},dependencies:[M,H,x,G,F]})};var Qe=()=>({category:"profilePicture",alt:"Profile Picture"}),Je=o=>[o];function Ke(o,r){if(o&1&&l(0,"app-information-alert",8),o&2){let e=g();i("message",e.errorMessage)}}var ce=class o{constructor(r,e,t){this.homeService=r;this.homeManagementService=e;this.loadingService=t}homeId;dataObject={};categories=[{name:"fullName",alias:"Fullname"},{name:"email",alias:"Email"},{name:"profilePicture",alias:"Profile picture"},{name:"canRecieveNotifications",alias:"Can recieve notifications"}];options=["fullName"];warningMessage="";offsetChange=5;limit=5;offset=0;hasMoreUsers=!0;errorMessage="";ngOnInit(){this.homeManagementService.homeId$.subscribe(r=>{r&&(this.homeId=r)}),this.fetchData(this.homeId)}fetchData(r,e){let t=e?`${e}&offset=${this.offset}&limit=${this.limit}`:`offset=${this.offset}&limit=${this.limit}`;this.loadingService.show(),this.homeService.getMembers(r,t).subscribe({next:m=>{let c=m.data.map(_=>({fullName:`${_.name} ${_.lastname}`,email:_.email,profilePicture:_.profilePicturePath,canRecieveNotifications:_.homePermissions.includes("ReceiveNotifications")}));this.dataObject=Ce(U({},m),{data:c,originalData:c}),this.loadingService.hide(),this.errorMessage=""},error:m=>{this.errorMessage="An error occurred while fetching data.",this.loadingService.hide()}})}static \u0275fac=function(e){return new(e||o)(p(v),p(b),p(y))};static \u0275cmp=f({type:o,selectors:[["app-listing-members"]],decls:10,vars:7,consts:[[1,"mb-4","text-center","text-primary","fw-bold"],[1,"container","mt-4","p-4","border","rounded","shadow","bg-light"],[1,"row","mt-3"],[1,"col-12"],[1,"bg-white","p-3","rounded","shadow-sm"],[3,"categories","dataObject","imageCategories"],[1,"row","mt-4"],["type","error",3,"message",4,"ngIf"],["type","error",3,"message"]],template:function(e,t){e&1&&(a(0,"h1",0),d(1,"Members"),s(),a(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4),l(6,"app-listing-table",5),s()()(),a(7,"div",6)(8,"div",3),w(9,Ke,1,1,"app-information-alert",7),s()()()),e&2&&(n(6),i("categories",t.categories)("dataObject",t.dataObject)("imageCategories",X(5,Je,K(4,Qe))),n(3),i("ngIf",t.errorMessage))},dependencies:[M,q,F]})};function Xe(o,r){if(o&1&&l(0,"app-information-alert",12),o&2){let e=g();i("message",e.successMessage)}}function Ye(o,r){if(o&1&&l(0,"app-information-alert",13),o&2){let e=g();i("message",e.errorMessage)}}var de=class o{constructor(r,e,t){this.homeService=r;this.homeManagementService=e;this.loadingService=t}homeId;errorMessage="";successMessage="";addHardwareForm;formField={modelNumber:{name:"modelNumber",required:"Model Number is required",class:"form-control"}};ngOnInit(){this.homeManagementService.homeId$.subscribe(r=>{r&&(this.homeId=r)}),this.addHardwareForm=new O({[this.formField.modelNumber.name]:new C("",[R.required])})}onSubmit=r=>{if(!this.addHardwareForm.valid)return;let e={ModelNumber:r[this.formField.modelNumber.name]};this.loadingService.show(),this.homeService.addHardware(this.homeId,e).subscribe({next:()=>{this.addHardwareForm.reset(),this.loadingService.hide(),this.successMessage="Hardware added successfully",this.errorMessage=""},error:t=>{this.errorMessage=t.details,this.successMessage="",this.loadingService.hide()}})};createClass="btn btn-primary w-100 mt-3";static \u0275fac=function(e){return new(e||o)(p(v),p(b),p(y))};static \u0275cmp=f({type:o,selectors:[["app-add-hardware"]],decls:14,vars:12,consts:[[1,"d-flex","justify-content-center"],[1,"container","p-5","shadow","rounded","bg-white",2,"max-width","700px"],[1,"text-center","mb-4","text-primary"],[1,"w-100",3,"ngSubmit","form"],[1,"mb-3"],[1,"form-label","text-muted",3,"for"],["type","text","placeholder","",3,"id","name","form","formField"],[1,"text-center","mt-4","d-grid","gap-2"],["title","Add"],[1,"col-12","mt-3"],["type","success",3,"message",4,"ngIf"],["type","error",3,"message",4,"ngIf"],["type","success",3,"message"],["type","error",3,"message"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"Add Device"),s(),a(4,"app-form",3),u("ngSubmit",function(){return t.onSubmit(t.addHardwareForm.value)}),a(5,"div",4)(6,"label",5),d(7,"Model Number"),s(),l(8,"app-form-input",6),s(),a(9,"div",7),l(10,"app-form-button",8),s(),a(11,"div",9),w(12,Xe,1,1,"app-information-alert",10)(13,Ye,1,1,"app-information-alert",11),s()()()()),e&2&&(n(4),i("form",t.addHardwareForm),n(2),h("for",t.formField.modelNumber.name),n(2),S(t.formField.modelNumber.class+" form-control"),h("id",t.formField.modelNumber.name),i("name",t.formField.modelNumber.name)("form",t.addHardwareForm)("formField",t.formField),n(2),S("btn btn-primary btn-lg w-100"),n(2),i("ngIf",t.successMessage),n(),i("ngIf",t.errorMessage))},dependencies:[M,H,x,G,F]})};var et=()=>({category:"mainPhoto",alt:"Device Image"}),tt=o=>[o];function rt(o,r){if(o&1&&l(0,"app-information-alert",11),o&2){let e=g();i("message",e.errorMessage)}}var ge=class o{constructor(r,e,t){this.homeService=r;this.homeManagementService=e;this.loadingService=t}homeId;listForm;dataObject={};rooms;roomsOptions=[];formField={rooms:{name:"rooms"}};categories=[{name:"name",alias:"Name"},{name:"modelNumber",alias:"Model number"},{name:"mainPhoto",alias:"Main photo"},{name:"lampIsOn",alias:"Is On"},{name:"doorSensorIsOpen",alias:"Is Open"},{name:"connectionStatus",alias:"Is Connected"}];errorMessage="";ngOnInit(){this.homeManagementService.homeId$.subscribe(r=>{r&&(this.homeId=r,this.loadRooms())}),this.listForm=new O({[this.formField.rooms.name]:new C("",[])})}onRoomChange(r){this.listForm.controls.rooms.setValue(r),r==="all"?this.fetchData(this.homeId):this.fetchData(this.homeId,r)}loadRooms(){this.loadingService.show(),this.homeService.getRooms(this.homeId).subscribe(r=>{this.loadingService.hide(),this.rooms=Array.isArray(r.data.rooms)?r.data.rooms:[r.data.rooms],this.roomsOptions=[{value:"all",label:"All Devices"},...this.rooms.map(e=>({value:e.name,label:`${e.name}`}))],this.listForm.get(this.formField.rooms.name)?.setValue(this.roomsOptions[0].value),this.fetchData(this.homeId)})}reloadRooms(){this.loadingService.show(),this.homeService.getRooms(this.homeId).subscribe(r=>{this.loadingService.hide(),this.rooms=Array.isArray(r.data.rooms)?r.data.rooms:[r.data.rooms],this.roomsOptions=[{value:"all",label:"All Devices"},...this.rooms.map(e=>({value:e.name,label:`${e.name}`}))]})}fetchData(r,e){let t="";e&&e!=="all"&&(t=`roomName=${e}`),this.loadingService.show(),this.homeService.getHardwares(r,t).subscribe({next:m=>{this.loadingService.hide(),console.log(m),this.processData(m.data),this.reloadRooms()},error:m=>{console.error("Error fetching hardwares:",m),this.errorMessage=m.details}})}processData(r){r.forEach(e=>{console.log(e),console.log(e.deviceType),e.deviceType!=="Lamp"&&(e.lampIsOn="-"),e.deviceType!=="Sensor"&&(e.doorSensorIsOpen="-")}),this.dataObject={data:r},console.log(this.dataObject)}static \u0275fac=function(e){return new(e||o)(p(v),p(b),p(y))};static \u0275cmp=f({type:o,selectors:[["app-listing-hardware"]],decls:16,vars:13,consts:[[1,"container","mt-4","p-4","border","rounded","shadow","bg-light",2,"width","80%"],[1,"row","text-center"],[1,"col-12"],[1,"mb-4","text-center","text-primary","fw-bold"],[1,"form-group","mb-3"],[1,"form-label","text-muted",3,"for"],[3,"selectedValueChange","id","options","selectedValue"],[1,"row","mt-4"],[1,"bg-white","p-3","rounded","shadow-sm"],[3,"categories","dataObject","imageCategories"],["type","error",3,"message",4,"ngIf"],["type","error",3,"message"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),d(4,"Home Devices"),s()()(),a(5,"div",4)(6,"label",5),d(7," Select a Room "),s(),a(8,"app-select",6),u("selectedValueChange",function(c){return t.onRoomChange(c)}),s()(),a(9,"div",7)(10,"div",2)(11,"div",8),l(12,"app-listing-table",9),s()()(),a(13,"div",7)(14,"div",2),w(15,rt,1,1,"app-information-alert",10),s()()()),e&2&&(n(6),h("for",t.formField.rooms.name),n(2),S(t.formField.rooms.class+" form-select"),h("id",t.formField.rooms.name),i("options",t.roomsOptions)("selectedValue",t.listForm.controls.rooms.value),n(4),i("categories",t.categories)("dataObject",t.dataObject)("imageCategories",X(11,tt,K(10,et))),n(3),i("ngIf",t.errorMessage))},dependencies:[M,q,F,P]})};function ot(o,r){if(o&1&&l(0,"app-information-alert",13),o&2){let e=g();i("message",e.SuccessMessage)}}function it(o,r){if(o&1&&l(0,"app-information-alert",14),o&2){let e=g();i("message",e.ErrorMessage)}}var he=class o{constructor(r,e,t){this.homeService=r;this.homeManagementService=e;this.loadingService=t}registerForm;hardwares;hardwareOptions=[];homeId="";SuccessMessage="";ErrorMessage="";formField={name:{name:"name",required:"name required",text:"name must be text",pattern:"name must be text only",class:"form-control"},hardwares:{name:"hardwares",class:"form-control"}};ngOnInit(){this.homeManagementService.homeId$.subscribe(r=>{r&&(this.homeId=r)}),this.registerForm=new O({[this.formField.name.name]:new C("",[R.required,R.pattern("^[a-zA-Z ]*$")]),[this.formField.hardwares.name]:new C("",[])}),this.loadHardwares()}loadHardwares(){this.loadingService.show(),this.homeService.getHardwares(this.homeId).subscribe(r=>{this.hardwares=r.data.filter(e=>!e.isInARoom),this.hardwareOptions=this.hardwares.map(e=>({value:e.id,label:`${e.name} - ${e.id}`})),this.loadingService.hide()})}onHardwareChange(r){this.registerForm.controls.hardwares.setValue(r)}onSubmit=r=>{if(!r.hardwares||r.hardwares.length===0||!Array.isArray(r.hardwares)){this.SuccessMessage="",this.ErrorMessage="Please select at least one hardware";return}let e=r[this.formField.name.name],t=r.hardwares;this.loadingService.show(),this.homeService.addRoom(this.homeId,{Name:e,HardwareIds:t}).subscribe({next:()=>{this.SuccessMessage="Room added successfully",this.ErrorMessage="",this.registerForm.reset(),this.removeSelectedHardwares(t),this.loadingService.hide()},error:m=>{this.SuccessMessage="",this.ErrorMessage=m.details,this.loadingService.hide()}})};removeSelectedHardwares(r){this.hardwares=this.hardwares.filter(e=>!r.includes(e.id)),this.hardwareOptions=this.hardwares.map(e=>({value:e.id,label:`${e.name} - ${e.id}`}))}static \u0275fac=function(e){return new(e||o)(p(v),p(b),p(y))};static \u0275cmp=f({type:o,selectors:[["app-create-room"]],decls:19,vars:18,consts:[[1,"container","p-5","shadow","rounded","bg-white",2,"max-width","700px"],[1,"text-center","mb-4","text-primary"],[1,"w-100",3,"ngSubmit","form"],[1,"mb-3"],[1,"form-label","text-muted",3,"for"],["type","text","placeholder","Hall",3,"id","name","form","formField"],[3,"selectedValueChange","id","options","isMultiple","selectedValue"],[1,"text-center","mt-4","d-grid","gap-2"],["type","submit",1,"w-100","btn","btn-primary","btn-lg","mb-3"],[1,"col-12","mt-3"],["type","success",3,"message",4,"ngIf"],["type","error",3,"message",4,"ngIf"],["type","info",3,"message"],["type","success",3,"message"],["type","error",3,"message"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"h1",1),d(2,"Group Devices by Room"),s(),a(3,"app-form",2),u("ngSubmit",function(){return t.onSubmit(t.registerForm.value)}),a(4,"div",3)(5,"label",4),d(6,"Room Name"),s(),l(7,"app-form-input",5),s(),a(8,"div",3)(9,"label",4),d(10,"Select Hardwares"),s(),a(11,"app-select",6),u("selectedValueChange",function(c){return t.onHardwareChange(c)}),s()(),a(12,"div",7)(13,"button",8),d(14,"Register"),s()(),a(15,"div",9),w(16,ot,1,1,"app-information-alert",10)(17,it,1,1,"app-information-alert",11),l(18,"app-information-alert",12),s()()()),e&2&&(n(3),i("form",t.registerForm),n(2),h("for",t.formField.name.name),n(2),S(t.formField.name.class+" form-control"),h("id",t.formField.name.name),i("name",t.formField.name.name)("form",t.registerForm)("formField",t.formField),n(2),h("for",t.formField.hardwares.name),n(2),S(t.formField.hardwares.class+" form-select"),h("id",t.formField.hardwares.name),i("options",t.hardwareOptions)("isMultiple",!0)("selectedValue",t.registerForm.controls.hardwares.value),n(5),i("ngIf",t.SuccessMessage),n(),i("ngIf",t.ErrorMessage),n(),i("message","Note that the above devices do not belong to any room"))},dependencies:[M,H,x,F,P],encapsulation:2})};var fe=class o extends te{constructor(e){super(ee.apiUrl,"hardwares",e);this.http=e}setHardwareRoom(e,t){return this.patch(t,`/${e}/room`)}changeHardwarename(e,t){return this.patch(t,`/${e}/name`)}static \u0275fac=function(t){return new(t||o)($(Y))};static \u0275prov=T({token:o,factory:o.\u0275fac,providedIn:"root"})};var z=class o{constructor(r){this.hardwareRepository=r}addHardwareToRoom(r,e){return this.hardwareRepository.setHardwareRoom(r,e)}changeHardwarename(r,e){return this.hardwareRepository.changeHardwarename(r,e)}static \u0275fac=function(e){return new(e||o)($(fe))};static \u0275prov=T({token:o,factory:o.\u0275fac,providedIn:"root"})};function at(o,r){if(o&1&&l(0,"app-information-alert",10),o&2){let e=g();i("message",e.SuccessMessage)}}function st(o,r){if(o&1&&l(0,"app-information-alert",11),o&2){let e=g();i("message",e.ErrorMessage)}}var ue=class o{constructor(r,e,t,m){this.homeService=r;this.homeManagementService=e;this.hardwareService=t;this.loadingService=m}registerForm;hardwares;hardwareOptions=[];rooms;roomsOptions=[];homeId="";SuccessMessage="";ErrorMessage="";formField={hardwares:{name:"hardwares",class:"form-control"},rooms:{name:"rooms",class:"form-control"}};ngOnInit(){this.homeManagementService.homeId$.subscribe(r=>{r&&(this.homeId=r)}),this.registerForm=new O({[this.formField.rooms.name]:new C("",[]),[this.formField.hardwares.name]:new C("",[])}),this.loadHardwares(),this.loadRooms()}loadHardwares(){this.loadingService.show(),this.homeService.getHardwares(this.homeId).subscribe(r=>{this.loadingService.hide(),this.hardwares=r.data.filter(e=>!e.isInARoom),this.hardwareOptions=this.hardwares.map(e=>({value:e.id,label:`${e.name} - ${e.id}`})),this.registerForm.get(this.formField.hardwares.name)?.setValue(this.hardwareOptions[0].value)})}loadRooms(){this.loadingService.show(),this.homeService.getRooms(this.homeId).subscribe(r=>{this.loadingService.hide(),this.rooms=Array.isArray(r.data.rooms)?r.data.rooms:[r.data.rooms],this.roomsOptions=this.rooms.map(e=>({value:e.id,label:`${e.name}`})),this.registerForm.get(this.formField.rooms.name)?.setValue(this.roomsOptions[0].value)})}onHardwareChange(r){this.registerForm.controls.hardwares.setValue(r)}onRoomChange(r){this.registerForm.controls.rooms.setValue(r)}onSubmit=r=>{if(console.log(r),!this.registerForm.valid){this.SuccessMessage="",this.ErrorMessage="Please fill the form correctly";return}if(!r.hardwares||r.hardwares.length===0){this.SuccessMessage="",this.ErrorMessage="Please select at least one hardware";return}if(!r.rooms){this.SuccessMessage="",this.ErrorMessage="Please select at least one room";return}let e=r.rooms,t=r.hardwares;this.loadingService.show(),this.hardwareService.addHardwareToRoom(t,{roomId:e}).subscribe({next:()=>{this.loadingService.hide(),this.SuccessMessage="Hardware added to room successfully",this.ErrorMessage="",this.removeSelectedHardwares(t),this.hardwareOptions.length===0?this.registerForm.get(this.formField.hardwares.name)?.setValue(""):this.registerForm.get(this.formField.hardwares.name)?.setValue(this.hardwareOptions[0].value)},error:m=>{this.SuccessMessage="",this.ErrorMessage=m.details,this.loadingService.hide()}})};removeSelectedHardwares(r){this.hardwares=this.hardwares.filter(e=>e.id!==r),this.hardwareOptions=this.hardwares.map(e=>({value:e.id,label:`${e.name} - ${e.id}`}))}registerClass="btn btn-primary";static \u0275fac=function(e){return new(e||o)(p(v),p(b),p(z),p(y))};static \u0275cmp=f({type:o,selectors:[["app-add-hardware-to-room"]],decls:17,vars:16,consts:[[1,"container","p-4","shadow-lg","rounded","bg-white",2,"max-width","700px"],[1,"text-center","mb-2","text-primary"],[3,"ngSubmit","form"],[1,"form-group","mb-3"],[1,"form-label","text-muted",3,"for"],[3,"selectedValueChange","id","options","selectedValue"],["type","submit",1,"w-100","btn","btn-primary","btn-lg","mb-3"],["type","success",3,"message",4,"ngIf"],["type","error",3,"message",4,"ngIf"],["type","info",3,"message"],["type","success",3,"message"],["type","error",3,"message"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"h1",1),d(2,"Add device to Room"),s(),a(3,"app-form",2),u("ngSubmit",function(){return t.onSubmit(t.registerForm.value)}),a(4,"div",3)(5,"label",4),d(6,"Select a Room"),s(),a(7,"app-select",5),u("selectedValueChange",function(c){return t.onRoomChange(c)}),s()(),a(8,"div",3)(9,"label",4),d(10,"Select a Device"),s(),a(11,"app-select",5),u("selectedValueChange",function(c){return t.onHardwareChange(c)}),s()(),a(12,"button",6),d(13," Register "),s(),w(14,at,1,1,"app-information-alert",7)(15,st,1,1,"app-information-alert",8),l(16,"app-information-alert",9),s()()),e&2&&(n(3),i("form",t.registerForm),n(2),h("for",t.formField.rooms.name),n(2),S(t.formField.rooms.class+" form-select"),h("id",t.formField.rooms.name),i("options",t.roomsOptions)("selectedValue",t.registerForm.controls.rooms.value),n(2),h("for",t.formField.hardwares.name),n(2),S(t.formField.hardwares.class+" form-select"),h("id",t.formField.hardwares.name),i("options",t.hardwareOptions)("selectedValue",t.registerForm.controls.hardwares.value),n(3),i("ngIf",t.SuccessMessage),n(),i("ngIf",t.ErrorMessage),n(),i("message","Note that the above devices do not belong to any room"))},dependencies:[M,H,F,P]})};function mt(o,r){if(o&1&&l(0,"app-information-alert",10),o&2){let e=g();i("message",e.SuccessMessage)}}function pt(o,r){if(o&1&&l(0,"app-information-alert",11),o&2){let e=g();i("message",e.ErrorMessage)}}var ve=class o{constructor(r,e,t){this.homeService=r;this.homeManagementService=e;this.loadingService=t}registerForm;homeId="";SuccessMessage="";ErrorMessage="";formField={name:{name:"name",required:"name is required",pattern:"name must be text only",class:"form-control"}};ngOnInit(){this.homeManagementService.homeId$.subscribe(r=>{r&&(this.homeId=r)}),this.registerForm=new O({[this.formField.name.name]:new C("",[R.required,R.pattern("^[a-zA-Z ]*$")])})}onSubmit=r=>{if(this.registerForm.invalid){this.ErrorMessage="Please fill all the required fields",this.SuccessMessage="";return}this.loadingService.show(),this.homeService.changeHomeName(this.homeId,r).subscribe({next:()=>{this.SuccessMessage="Home name changed successfully",this.ErrorMessage="",this.loadingService.hide()},error:e=>{this.SuccessMessage="",this.ErrorMessage=e.details,this.loadingService.hide()}})};static \u0275fac=function(e){return new(e||o)(p(v),p(b),p(y))};static \u0275cmp=f({type:o,selectors:[["app-change-room-name"]],decls:13,vars:11,consts:[[1,"container","p-4","shadow-lg","rounded","bg-white",2,"max-width","700px"],[1,"text-center","mb-2","text-primary"],[3,"ngSubmit","form"],[1,"form-group","mb-3"],[1,"form-label","text-muted",3,"for"],["type","text","placeholder","Winter Home",3,"id","name","form","formField"],["type","submit",1,"w-100","btn","btn-primary","btn-lg","mb-3"],["type","success",3,"message",4,"ngIf"],["type","error",3,"message",4,"ngIf"],["type","info",3,"message"],["type","success",3,"message"],["type","error",3,"message"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"h1",1),d(2,"Change home name"),s(),a(3,"app-form",2),u("ngSubmit",function(){return t.onSubmit(t.registerForm.value)}),a(4,"div",3)(5,"label",4),d(6,"New home name"),s(),l(7,"app-form-input",5),s(),a(8,"button",6),d(9," Register "),s(),w(10,mt,1,1,"app-information-alert",7)(11,pt,1,1,"app-information-alert",8),l(12,"app-information-alert",9),s()()),e&2&&(n(3),i("form",t.registerForm),n(2),h("for",t.formField.name.name),n(2),S(t.formField.name.class),h("id",t.formField.name.name),i("name",t.formField.name.name)("form",t.registerForm)("formField",t.formField),n(3),i("ngIf",t.SuccessMessage),n(),i("ngIf",t.ErrorMessage),n(),i("message","Note that the above devices do not belong to any room"))},dependencies:[M,H,x,F]})};function lt(o,r){if(o&1&&l(0,"app-information-alert",10),o&2){let e=g();i("message",e.SuccessMessage)}}function ct(o,r){if(o&1&&l(0,"app-information-alert",11),o&2){let e=g();i("message",e.ErrorMessage)}}var be=class o{constructor(r,e,t,m){this.hardwareService=r;this.homeService=e;this.homeManagementService=t;this.loadingService=m}registerForm;hardwares;hardwareOptions=[];homeId="";SuccessMessage="";ErrorMessage="";formField={name:{name:"name",required:"name required",text:"name must be text",pattern:"name must be text only",class:"form-control"},hardwares:{name:"hardwares",required:"hardwares required",class:"form-control"}};ngOnInit(){this.homeManagementService.homeId$.subscribe(r=>{r&&(this.homeId=r)}),this.registerForm=new O({[this.formField.name.name]:new C("",[R.required,R.pattern("^[a-zA-Z ]*$")]),[this.formField.hardwares.name]:new C("",[])}),this.loadHardwares()}onHardwareChange(r){this.registerForm.controls.hardwares.setValue(r)}loadHardwares(){this.loadingService.show(),this.homeService.getHardwares(this.homeId).subscribe(r=>{this.loadingService.hide(),this.hardwares=r.data,this.hardwareOptions=this.hardwares.map(e=>({value:e.id,label:`${e.name} - ${e.id}`})),this.registerForm.get(this.formField.hardwares.name)?.setValue(this.hardwareOptions[0].value)})}onSubmit=r=>{if(this.registerForm.invalid){this.ErrorMessage="Please fill all the required fields",this.SuccessMessage="";return}let e=r.hardwares,t=r.name;console.log(r),console.log(t),console.log(e),this.loadingService.show(),this.hardwareService.changeHardwarename(e,{Name:t}).subscribe({next:m=>{this.loadingService.hide(),this.SuccessMessage="Device name changed successfully",this.ErrorMessage="",this.loadHardwares()},error:m=>{this.loadingService.hide(),this.SuccessMessage="",this.ErrorMessage=m.details}})};static \u0275fac=function(e){return new(e||o)(p(z),p(v),p(b),p(y))};static \u0275cmp=f({type:o,selectors:[["app-change-hardware-name"]],decls:17,vars:16,consts:[[1,"container","p-4","shadow-lg","rounded","bg-white",2,"max-width","700px"],[1,"text-center","mb-2","text-primary"],[3,"ngSubmit","form"],[1,"form-group","mb-3"],[1,"form-label","text-muted",3,"for"],[3,"selectedValueChange","id","options","selectedValue"],["type","text","placeholder","Hall Camera",3,"id","name","form","formField"],["type","submit",1,"w-100","btn","btn-primary","btn-lg","mb-3"],["type","success",3,"message",4,"ngIf"],["type","error",3,"message",4,"ngIf"],["type","success",3,"message"],["type","error",3,"message"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"h1",1),d(2,"Change device name"),s(),a(3,"app-form",2),u("ngSubmit",function(){return t.onSubmit(t.registerForm.value)}),a(4,"div",3)(5,"label",4),d(6,"Select a Device"),s(),a(7,"app-select",5),u("selectedValueChange",function(c){return t.onHardwareChange(c)}),d(8," >"),s()(),a(9,"div",3)(10,"label",4),d(11,"New Device name"),s(),l(12,"app-form-input",6),s(),a(13,"button",7),d(14," Register "),s(),w(15,lt,1,1,"app-information-alert",8)(16,ct,1,1,"app-information-alert",9),s()()),e&2&&(n(3),i("form",t.registerForm),n(2),h("for",t.formField.hardwares.name),n(2),S(t.formField.hardwares.class+" form-select"),h("id",t.formField.hardwares.name),i("options",t.hardwareOptions)("selectedValue",t.registerForm.controls.hardwares.value),n(3),h("for",t.formField.name.name),n(2),S(t.formField.name.class),h("id",t.formField.name.name),i("name",t.formField.name.name)("form",t.registerForm)("formField",t.formField),n(3),i("ngIf",t.SuccessMessage),n(),i("ngIf",t.ErrorMessage))},dependencies:[M,H,x,F,P]})};var Se=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=f({type:o,selectors:[["app-welcome-home-mangement-no-permissions"]],decls:1,vars:2,consts:[["imagePath","home-owner-welcome.png",3,"hasPermissions","title"]],template:function(e,t){e&1&&l(0,"app-welcome",0),e&2&&i("hasPermissions",!1)("title","Home Management")},dependencies:[B]})};var dt=[{path:"",component:se,children:[{path:"",redirectTo:"welcome",pathMatch:"full"},{path:"welcome",component:me},{path:"welcome-no-permissions",component:Se},{path:"add-member",component:pe},{path:"list-members",component:ce},{path:"add-device",component:de},{path:"list-devices",component:ge},{path:"create-room",component:he},{path:"add-device-to-room",component:ue},{path:"change-home-name",component:ve},{path:"change-device-name",component:be},{path:"grant-home-permissions",component:ne}]}],we=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=J({type:o});static \u0275inj=Q({imports:[ye.forChild(dt),ye]})};var Ve=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=J({type:o});static \u0275inj=Q({imports:[Oe,we,re,B,Te,je,H,x,G,q,Ae,q,oe,P]})};export{Ve as a};
