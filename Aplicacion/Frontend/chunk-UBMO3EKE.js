import{a as f,b}from"./chunk-YJRYK5MZ.js";import{a as z}from"./chunk-GEBP7ZCE.js";import{a as q}from"./chunk-PTJDRHHQ.js";import{a as L}from"./chunk-BZ2FDTJU.js";import{A as a,Aa as F,B as s,Ba as W,C as m,F as B,G as T,H as h,K as j,Y as G,_ as V,c as N,fa as k,ga as u,j as c,ja as A,k as P,l as o,m as C,n as S,na as J,p as O,q as D,s as H,t as l,u as v,ua as K,v as _,x as n,xa as y,ya as Q,za as R}from"./chunk-EPVYEA6G.js";var I=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=C({type:t,selectors:[["app-role-page"]],decls:2,vars:0,template:function(e,i){e&1&&m(0,"app-header")(1,"router-outlet")},dependencies:[k,b]})};var x=class t{constructor(r,e){this.userRoleService=r;this.router=e}canActivate(){return this.userRoleService.getUserRoles().includes("Admin")?!0:(this.router.navigate([""]),!1)}static \u0275fac=function(e){return new(e||t)(o(f),o(u))};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};var U=class t{constructor(r,e){this.userRoleService=r;this.router=e}canActivate(){return this.userRoleService.getUserRoles().includes("CompanyOwner")?!0:(this.router.navigate([""]),!1)}static \u0275fac=function(e){return new(e||t)(o(f),o(u))};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};var g=class t{constructor(r,e){this.userRoleService=r;this.router=e}canActivate(){return console.log("roles: ",this.userRoleService.getUserRoles()),this.userRoleService.getUserRoles().includes("HomeOwner")?!0:(this.router.navigate([""]),!1)}static \u0275fac=function(e){return new(e||t)(o(f),o(u))};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})};function $(t,r){if(t&1&&m(0,"app-information-alert",17),t&2){let e=h(2);n("message",e.successMessage)}}function ee(t,r){if(t&1&&m(0,"app-information-alert",18),t&2){let e=h(2);n("message",e.errorMessage)}}function te(t,r){if(t&1){let e=B();a(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h1",6),j(6,"Update Profile Picture"),s(),a(7,"label",7),j(8,"Current Profile Picture:"),s(),a(9,"div",8),m(10,"img",9),s(),a(11,"app-form",10),T("ngSubmit",function(){O(e);let p=h();return D(p.onSubmit())}),a(12,"div",11),m(13,"app-form-input",12),s(),a(14,"div",8),m(15,"app-form-button",13),s()(),a(16,"div",14),_(17,$,1,1,"app-information-alert",15)(18,ee,1,1,"app-information-alert",16),s()()()()()()}if(t&2){let e=h();l(10),n("src",e.profilePicturePath,H),l(),n("form",e.updateForm),l(2),n("id",e.formField.path.name)("label",e.formField.path.name)("name",e.formField.path.name)("form",e.updateForm)("formField",e.formField),l(4),n("ngIf",e.successMessage),l(),n("ngIf",e.errorMessage)}}var w=class t{constructor(r,e,i,p){this.authService=r;this.userService=e;this.fb=i;this.sharedService=p}profilePicturePath="";userEmail="";dataLoaded=!1;updateForm;errorMessage="";successMessage="";formField={path:{name:"profilePicturePath"}};ngOnInit(){this.loadUserData(),this.updateForm=this.fb.group({profilePicturePath:[""]})}loadUserData(){return N(this,null,function*(){try{let r=yield this.getEmail();r&&(this.userEmail=r),this.userEmail&&(this.profilePicturePath=yield this.getProfilePath(this.userEmail)),this.dataLoaded=!0}catch(r){console.error("Error loading user data:",r)}})}getProfilePath(r){return new Promise((e,i)=>{this.userService.getProfilePicture(r).subscribe({next:p=>{e(p.data)},error:p=>{i(p)}})})}getEmail(){return new Promise((r,e)=>{let i=this.authService.getEmail();i?r(i):e("No email found")})}onSubmit(){if(this.updateForm.valid){let r=this.updateForm.get(this.formField.path.name)?.value;if(r){let e={ProfilePicturePath:r};this.userService.updateProfilePicture(this.userEmail,e).subscribe({next:i=>{this.errorMessage="",this.successMessage=i.message,this.sharedService.emitProfilePictureUpdated(),this.profilePicturePath=r,this.updateForm.reset()},error:i=>{this.errorMessage=i.details,console.error("Error updating profile picture:",i)}})}else{this.successMessage="",this.errorMessage="Please fill out the required fields.";return}}else{this.successMessage="",this.errorMessage="Please fill out the required fields.";return}}static \u0275fac=function(e){return new(e||t)(v(L),v(q),v(K),v(z))};static \u0275cmp=C({type:t,selectors:[["app-update-profile-picture"]],decls:1,vars:1,consts:[["class","container mt-4",4,"ngIf"],[1,"container","mt-4"],[1,"row","justify-content-center"],[1,"col-md-6"],[1,"card","shadow-lg","rounded-3"],[1,"card-body"],[1,"text-center","mb-4","text-primary"],[1,"form-label"],[1,"d-flex","justify-content-center","mb-4"],["alt","Profile Picture","width","200","height","200",1,"rounded-circle","border","border-4","mb-3",3,"src"],[3,"ngSubmit","form"],[1,"mb-3"],["type","text","placeholder","https://www.w3schools.com/howto/img_avatar.png",1,"mt-3",3,"id","label","name","form","formField"],["title","Update Profile Picture",1,"btn","btn-primary"],[1,"mt-3"],["type","success","class","mb-3",3,"message",4,"ngIf"],["type","error","class","mb-3",3,"message",4,"ngIf"],["type","success",1,"mb-3",3,"message"],["type","error",1,"mb-3",3,"message"]],template:function(e,i){e&1&&_(0,te,19,9,"div",0),e&2&&n("ngIf",i.dataLoaded)},dependencies:[G,y,R,F,W],encapsulation:2})};var re=[{path:"",component:I,children:[{path:"admin",canActivate:[x],loadChildren:()=>import("./chunk-JDZQKIJK.js").then(t=>t.AdminModule)},{path:"company-owner",canActivate:[U],loadChildren:()=>import("./chunk-CCWYKJ6M.js").then(t=>t.CompanyOwnerModule)},{path:"home-owner",canActivate:[g],loadChildren:()=>import("./chunk-Z7DR34C4.js").then(t=>t.HomeOwnerModule)},{path:"home-management/:id",loadChildren:()=>import("./chunk-54MB464J.js").then(t=>t.HomeManagementModule)},{path:"update-profile-picture",canActivate:[g],component:w}]}],M=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=S({type:t});static \u0275inj=P({imports:[A.forChild(re),A]})};var Y=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=S({type:t});static \u0275inj=P({imports:[V,M,b,y,R,F,Q,J]})};export{Y as RolesModule};
