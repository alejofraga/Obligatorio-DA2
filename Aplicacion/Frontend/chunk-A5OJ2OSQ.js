import{a as oe}from"./chunk-OCK2G6WJ.js";import{a as A,c as ae,e as se}from"./chunk-7X5LL6QE.js";import{a as P,b as re,c as S,d as w}from"./chunk-VER4IG53.js";import{a as E}from"./chunk-PTJDRHHQ.js";import{A as s,Aa as x,B as a,Ba as _,C as l,G as c,H as d,I as v,K as g,Q as K,Y as y,_ as X,a as F,b as I,ea as Y,fa as V,ga as ee,ja as z,k as T,m as u,ma as b,n as U,na as te,pa as C,ra as ie,sa as R,t as o,u as f,v as h,x as r,xa as N,ya as ne,z as M,za as $}from"./chunk-EPVYEA6G.js";var k=class n{sideBarItems=[{title:"User",operations:["List devices","List supported devices"]},{title:"Admin",operations:["Register Admin","Register Company owner","List accounts","List companies","Remove admin"]}];static \u0275fac=function(i){return new(i||n)};static \u0275cmp=u({type:n,selectors:[["app-admin-page"]],decls:5,vars:1,consts:[[1,"d-flex",2,"height","100vh"],[1,"flex-shrink-0",3,"items"],[1,"flex-grow-1","d-flex","align-items-start","justify-content-center","p-4"],[1,"w-100",2,"max-width","1000px","margin-left","280px"]],template:function(i,e){i&1&&(s(0,"div",0),l(1,"app-sidebar",1),s(2,"div",2)(3,"div",3),l(4,"router-outlet"),a()()()),i&2&&(o(),r("items",e.sideBarItems))},dependencies:[V,P]})};var L=class n{adminImagePath="admin-home-config.jpg";static \u0275fac=function(i){return new(i||n)};static \u0275cmp=u({type:n,selectors:[["app-welcome-admin"]],standalone:!0,features:[K],decls:1,vars:2,consts:[[3,"title","imagePath"]],template:function(i,e){i&1&&l(0,"app-welcome",0),i&2&&r("title","admin")("imagePath",e.adminImagePath)},dependencies:[re]})};function ue(n,t){n&1&&(s(0,"h1",15),g(1," Register an Admin "),a())}function he(n,t){n&1&&(s(0,"h1",15),g(1," Register a Company Owner "),a())}function ve(n,t){if(n&1&&l(0,"app-information-alert",16),n&2){let i=d();r("message",i.SuccessMessage)}}function Ce(n,t){if(n&1&&l(0,"app-information-alert",17),n&2){let i=d();r("message",i.ErrorMessage)}}var D=class n{constructor(t,i,e){this.userService=t;this.route=i;this.loadingService=e}registerForm;SuccessMessage="";ErrorMessage="";role;formField={email:{name:"email",required:"email required",email:"email must be a valid email address",class:"form-control"},password:{name:"password",required:"password required",minlength:"password must be at least 6 characters",class:"form-control"},name:{name:"name",required:"name required",pattern:"name must contain only letters and spaces",class:"form-control"},lastname:{name:"lastname",required:"lastname required",pattern:"lastname must contain only letters and spaces",class:"form-control"}};ngOnInit(){this.route.data.subscribe(t=>{this.role=t.role||this.role}),this.registerForm=new ie({[this.formField.email.name]:new R("",[C.required,C.email]),[this.formField.password.name]:new R("",[C.required,C.minLength(6)]),[this.formField.name.name]:new R("",[C.required,C.pattern("^[a-zA-Z ]*$")]),[this.formField.lastname.name]:new R("",[C.required,C.pattern("^[a-zA-Z ]*$")])})}onSubmit=t=>{if(!this.registerForm.valid){this.ErrorMessage="Please fill the form correctly",this.SuccessMessage="";return}let i=t[this.formField.email.name],e=t[this.formField.password.name],m=t[this.formField.lastname.name],p=t[this.formField.name.name],ge=this.role;this.loadingService.show(),this.userService.register(p,m,i,e,ge).subscribe({next:()=>{this.SuccessMessage="User registered successfully",this.ErrorMessage="",this.registerForm.reset(),this.loadingService.hide()},error:H=>{this.ErrorMessage=H.details,this.SuccessMessage="",console.error("Error en el registro:",H),this.loadingService.hide()}})};registerClass="btn btn-primary ";static \u0275fac=function(i){return new(i||n)(f(E),f(Y),f(b))};static \u0275cmp=u({type:n,selectors:[["app-register-user"]],decls:26,vars:35,consts:[[1,"d-flex","justify-content-center"],[1,"container","p-5","shadow","rounded","bg-white",2,"max-width","600px"],["class","text-center mb-4 text-primary",4,"ngIf"],[1,"w-100",3,"ngSubmit","form"],[1,"mb-3"],[1,"form-label","text-muted",3,"for"],["type","text","placeholder","John",3,"id","name","form","formField"],["type","text","placeholder","Doe",3,"id","name","form","formField"],["type","text","placeholder","email@example.com",3,"id","name","form","formField"],["type","password","placeholder","*****",3,"id","name","form","formField"],[1,"text-center","mt-4","d-grid","gap-2"],["title","Register"],[1,"col-12","mt-3"],["type","success",3,"message",4,"ngIf"],["type","error",3,"message",4,"ngIf"],[1,"text-center","mb-4","text-primary"],["type","success",3,"message"],["type","error",3,"message"]],template:function(i,e){i&1&&(s(0,"div",0)(1,"div",1),h(2,ue,2,0,"h1",2)(3,he,2,0,"h1",2),s(4,"app-form",3),c("ngSubmit",function(){return e.onSubmit(e.registerForm.value)}),s(5,"div",4)(6,"label",5),g(7,"First Name"),a(),l(8,"app-form-input",6),a(),s(9,"div",4)(10,"label",5),g(11,"Last Name"),a(),l(12,"app-form-input",7),a(),s(13,"div",4)(14,"label",5),g(15,"Email"),a(),l(16,"app-form-input",8),a(),s(17,"div",4)(18,"label",5),g(19,"Password"),a(),l(20,"app-form-input",9),a(),s(21,"div",10),l(22,"app-form-button",11),a(),s(23,"div",12),h(24,ve,1,1,"app-information-alert",13)(25,Ce,1,1,"app-information-alert",14),a()()()()),i&2&&(o(2),r("ngIf",e.role==="Admin"),o(),r("ngIf",e.role==="CompanyOwner"),o(),r("form",e.registerForm),o(2),v("for",e.formField.name.name),o(2),M(e.formField.name.class),v("id",e.formField.name.name),r("name",e.formField.name.name)("form",e.registerForm)("formField",e.formField),o(2),v("for",e.formField.lastname.name),o(2),M(e.formField.lastname.class),v("id",e.formField.lastname.name),r("name",e.formField.lastname.name)("form",e.registerForm)("formField",e.formField),o(2),v("for",e.formField.email.name),o(2),M(e.formField.email.class),v("id",e.formField.email.name),r("name",e.formField.email.name)("form",e.registerForm)("formField",e.formField),o(2),v("for",e.formField.password.name),o(2),M(e.formField.password.class),v("id",e.formField.password.name),r("name",e.formField.password.name)("form",e.registerForm)("formField",e.formField),o(2),M("btn btn-primary btn-lg w-100"),o(2),r("ngIf",e.SuccessMessage),o(),r("ngIf",e.ErrorMessage))},dependencies:[y,N,$,x,_],encapsulation:2})};function ye(n,t){if(n&1&&l(0,"app-information-alert",13),n&2){let i=d();r("message",i.warningMessage)}}function be(n,t){if(n&1&&l(0,"app-information-alert",14),n&2){let i=d();r("message",i.errorMessage)}}var q=class n{constructor(t,i){this.userService=t;this.loadingService=i}dataObject={};categories=[{name:"name",alias:"Name"},{name:"lastname",alias:"Lastname"},{name:"fullname",alias:"Full name"},{name:"roles",alias:"Roles"},{name:"accountCreationDate",alias:"Creation date"}];options=["fullname","role"];warningMessage="";offsetChange=5;limit=5;offset=0;hasMoreUsers=!0;errorMessage="";ngOnInit(){this.fetchData()}onFilterChange(t){let i=Object.keys(t).filter(m=>t[m]&&t[m].trim()!=="").reduce((m,p)=>(m[p]=t[p],m),{}),e=this.buildQueryString(i);setTimeout(()=>{this.offset=0,this.fetchData(e)},500)}fetchData(t){let i=t?`${t}&offset=${this.offset}&limit=${this.limit}`:`offset=${this.offset}&limit=${this.limit}`;this.loadingService.show(),this.userService.getUsers(i).subscribe({next:e=>{this.dataObject=I(F({},e),{originalData:e.data}),this.hasMoreUsers=e.data.length===this.limit,this.loadingService.hide()},error:e=>{console.error("Error fetching users:",e),this.errorMessage=e.details,this.loadingService.hide()}})}buildQueryString(t){return Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&")}onChangeOffset(t){t<0||(this.offset=t,this.fetchData())}static \u0275fac=function(i){return new(i||n)(f(E),f(b))};static \u0275cmp=u({type:n,selectors:[["app-listing-accounts"]],decls:19,vars:11,consts:[[1,"mb-4","text-center","text-primary","fw-bold"],[1,"container","mt-2","p-4","border","rounded","shadow","bg-light"],[1,"row"],[1,"col-12"],[1,"bg-white","p-3","rounded","shadow-sm"],[3,"filterChange","filterOptions"],[1,"row","mt-4"],[3,"categories","dataObject"],[1,"col-12","d-flex","justify-content-between"],["title","Previous",1,"btn","btn-primary",3,"changeOffsetEvent","currentOffset","changeOffset","disabled"],["title","Next",1,"btn","btn-primary",3,"changeOffsetEvent","currentOffset","changeOffset","disabled"],["type","warning","class","",3,"message",4,"ngIf"],["type","error","class","",3,"message",4,"ngIf"],["type","warning",1,"",3,"message"],["type","error",1,"",3,"message"]],template:function(i,e){i&1&&(s(0,"h1",0),g(1,"User Accounts"),a(),s(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-listing-filter",5),c("filterChange",function(p){return e.onFilterChange(p)}),a()()()(),s(7,"div",6)(8,"div",3)(9,"div",4),l(10,"app-listing-table",7),a()()(),s(11,"div",6)(12,"div",8)(13,"app-listing-button",9),c("changeOffsetEvent",function(p){return e.onChangeOffset(p)}),a(),s(14,"app-listing-button",10),c("changeOffsetEvent",function(p){return e.onChangeOffset(p)}),a()()(),s(15,"div",2)(16,"div",3),h(17,ye,1,1,"app-information-alert",11)(18,be,1,1,"app-information-alert",12),a()()()),i&2&&(o(6),r("filterOptions",e.options),o(4),r("categories",e.categories)("dataObject",e.dataObject),o(3),r("currentOffset",e.offset)("changeOffset",-e.offsetChange)("disabled",e.offset===0),o(),r("currentOffset",e.offset)("changeOffset",e.offsetChange)("disabled",!e.hasMoreUsers),o(3),r("ngIf",e.warningMessage),o(),r("ngIf",e.errorMessage))},dependencies:[y,S,A,w,_]})};function _e(n,t){if(n&1&&l(0,"app-information-alert",13),n&2){let i=d();r("message",i.warningMessage)}}function Se(n,t){if(n&1&&l(0,"app-information-alert",14),n&2){let i=d();r("message",i.errorMessage)}}var B=class n{constructor(t,i){this.companyService=t;this.loadingService=i}dataObject={};categories=[{name:"ownerFullName",alias:"Owner Fullname"},{name:"companyName",alias:"Company name"},{name:"rut",alias:"RUT"},{name:"ownerEmail",alias:"Owner email"}];options=["companyName","ownerFullname"];warningMessage="";offsetChange=5;limit=5;offset=0;hasMoreCompanies=!0;errorMessage="";ngOnInit(){this.fetchData()}fetchData(t){let i=t?`${t}&offset=${this.offset}&limit=${this.limit}`:`offset=${this.offset}&limit=${this.limit}`;this.loadingService.show(),this.companyService.getCompanies(i).subscribe({next:e=>{this.dataObject=I(F({},e),{originalData:e.data}),this.hasMoreCompanies=e.data.length===this.limit,this.loadingService.hide()},error:e=>{console.error("Error fetching companies:",e),this.errorMessage=e.details||"An error occurred while fetching companies",this.loadingService.hide()}})}onChangeOffset(t){t<0||(this.offset=t,this.fetchData())}onFilterChange(t){let i=Object.keys(t).filter(m=>t[m]&&t[m].trim()!=="").reduce((m,p)=>(m[p]=t[p],m),{}),e=this.buildQueryString(i);setTimeout(()=>{this.offset=0,this.fetchData(e)},500)}buildQueryString(t){return Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&")}static \u0275fac=function(i){return new(i||n)(f(oe),f(b))};static \u0275cmp=u({type:n,selectors:[["app-listing-companies"]],decls:19,vars:11,consts:[[1,"mb-4","text-center","text-primary","fw-bold"],[1,"container","mt-2","p-4","border","rounded","shadow","bg-light"],[1,"row"],[1,"col-12"],[1,"bg-white","p-3","rounded","shadow-sm"],[3,"filterChange","filterOptions"],[1,"row","mt-4"],[3,"categories","dataObject"],[1,"col-12","d-flex","justify-content-between"],["title","Previous",1,"btn","btn-primary",3,"changeOffsetEvent","currentOffset","changeOffset","disabled"],["title","Next",1,"btn","btn-primary",3,"changeOffsetEvent","currentOffset","changeOffset","disabled"],["type","warning","class","alert alert-warning",3,"message",4,"ngIf"],["type","error","class","",3,"message",4,"ngIf"],["type","warning",1,"alert","alert-warning",3,"message"],["type","error",1,"",3,"message"]],template:function(i,e){i&1&&(s(0,"h1",0),g(1,"Companies"),a(),s(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-listing-filter",5),c("filterChange",function(p){return e.onFilterChange(p)}),a()()()(),s(7,"div",6)(8,"div",3)(9,"div",4),l(10,"app-listing-table",7),a()()(),s(11,"div",6)(12,"div",8)(13,"app-listing-button",9),c("changeOffsetEvent",function(p){return e.onChangeOffset(p)}),a(),s(14,"app-listing-button",10),c("changeOffsetEvent",function(p){return e.onChangeOffset(p)}),a()()(),s(15,"div",2)(16,"div",3),h(17,_e,1,1,"app-information-alert",11)(18,Se,1,1,"app-information-alert",12),a()()()),i&2&&(o(6),r("filterOptions",e.options),o(4),r("categories",e.categories)("dataObject",e.dataObject),o(3),r("currentOffset",e.offset)("changeOffset",-e.offsetChange)("disabled",e.offset===0),o(),r("currentOffset",e.offset)("changeOffset",e.offsetChange)("disabled",!e.hasMoreCompanies),o(3),r("ngIf",e.warningMessage),o(),r("ngIf",e.errorMessage))},dependencies:[y,S,A,w,_]})};function we(n,t){if(n&1&&l(0,"app-information-alert",15),n&2){let i=d();r("message",i.warningMessage)}}function Oe(n,t){if(n&1&&l(0,"app-information-alert",16),n&2){let i=d();r("message",i.errorMessage)}}function Fe(n,t){if(n&1&&l(0,"app-information-alert",17),n&2){let i=d();r("message",i.successMessage)}}var Q=class n{constructor(t,i,e){this.userService=t;this.router=i;this.loadingService=e}dataObject={};categories=[{name:"email",alias:"Email"},{name:"name",alias:"Name"},{name:"lastname",alias:"Lastname"},{name:"fullname",alias:"Fullname"},{name:"accountCreationDate",alias:"Creation date"},{name:"Action",alias:""}];actionCategories=[{category:"Action",class:"btn btn-danger",title:"Delete",onClick:t=>this.deleteOption(t)}];options=["fullname"];warningMessage="";offsetChange=3;limit=3;offset=0;hasMoreUsers=!0;successMessage="";errorMessage="";ngOnInit(){this.fetchData()}onFilterChange(t){let i=Object.keys(t).filter(m=>t[m]&&t[m].trim()!=="").reduce((m,p)=>(m[p]=t[p],m),{}),e=this.buildQueryString(i);setTimeout(()=>{this.offset=0,this.fetchData(e)},500)}fetchData(t){t=`${t}&role=Admin`;let i=t?`${t}&offset=${this.offset}&limit=${this.limit}`:`offset=${this.offset}&limit=${this.limit}`;this.loadingService.show(),this.userService.getUsers(i).subscribe({next:e=>{this.dataObject=I(F({},e),{originalData:e.data}),this.hasMoreUsers=e.data.length===this.limit,this.loadingService.hide()},error:e=>{this.errorMessage=e.details||"An error occurred while fetching users",this.loadingService.hide()}})}buildQueryString(t){return Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&")}onChangeOffset(t){t<0||(this.offset=t,this.fetchData())}deleteOption(t){confirm("This process is irreversible. Are you sure you want to continue?")&&this.removeAdmin(t)}removeAdmin=t=>{this.userService.removeAdmin({Email:t.email}).subscribe({next:()=>{this.successMessage="Admin removed successfully",this.errorMessage="",this.fetchData()},error:i=>{this.errorMessage=i.details||"An error occurred while removing admin",this.successMessage=""}})};static \u0275fac=function(i){return new(i||n)(f(E),f(ee),f(b))};static \u0275cmp=u({type:n,selectors:[["app-remove-admin"]],decls:23,vars:14,consts:[[1,"mb-4","text-center","text-primary","fw-bold"],[1,"container","mt-2","p-4","border","rounded","shadow","bg-light","mb-4"],[1,"row"],[1,"col-12"],[1,"bg-white","p-3","rounded","shadow-sm"],[3,"filterChange","filterOptions"],[1,"row","mt-4"],["buttonIcon","bi bi-person-x-fill",3,"categories","actionCategories","dataObject"],[1,"col-12","d-flex","justify-content-between"],["title","Previous",1,"btn","btn-primary",3,"changeOffsetEvent","currentOffset","changeOffset","disabled"],["title","Next",1,"btn","btn-primary",3,"changeOffsetEvent","currentOffset","changeOffset","disabled"],["type","warning",3,"message",4,"ngIf"],["type","error",3,"message",4,"ngIf"],["type","success",3,"message",4,"ngIf"],[1,"",3,"message"],["type","warning",3,"message"],["type","error",3,"message"],["type","success",3,"message"]],template:function(i,e){i&1&&(s(0,"h1",0),g(1,"Remove Admin"),a(),s(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"app-listing-filter",5),c("filterChange",function(p){return e.onFilterChange(p)}),a()()()(),s(7,"div",6)(8,"div",3)(9,"div",4),l(10,"app-listing-table",7),a()()(),s(11,"div",6)(12,"div",8)(13,"app-listing-button",9),c("changeOffsetEvent",function(p){return e.onChangeOffset(p)}),a(),s(14,"app-listing-button",10),c("changeOffsetEvent",function(p){return e.onChangeOffset(p)}),a()()(),s(15,"div",6)(16,"div",3),h(17,we,1,1,"app-information-alert",11)(18,Oe,1,1,"app-information-alert",12)(19,Fe,1,1,"app-information-alert",13),a()(),s(20,"div",2)(21,"div",3),l(22,"app-information-alert",14),a()()()),i&2&&(o(6),r("filterOptions",e.options),o(4),r("categories",e.categories)("actionCategories",e.actionCategories)("dataObject",e.dataObject),o(3),r("currentOffset",e.offset)("changeOffset",-e.offsetChange)("disabled",e.offset===0),o(),r("currentOffset",e.offset)("changeOffset",e.offsetChange)("disabled",!e.hasMoreUsers),o(3),r("ngIf",e.warningMessage),o(),r("ngIf",e.errorMessage),o(),r("ngIf",e.successMessage),o(3),r("message","Deletion of users who are exclusively administrators is supported, deletion of users with other roles is not supported."))},dependencies:[y,S,A,w,_]})};var Ie=[{path:"",component:k,children:[{path:"",redirectTo:"welcome",pathMatch:"full"},{path:"welcome",component:L},{path:"register-admin",component:D,data:{role:"Admin"}},{path:"register-company-owner",component:D,data:{role:"CompanyOwner"}},{path:"list-accounts",component:q},{path:"list-companies",component:B},{path:"list-devices",component:ae},{path:"remove-admin",component:Q},{path:"list-supported-devices",component:se}]}],W=class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=U({type:n});static \u0275inj=T({imports:[z.forChild(Ie),z]})};var de=class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=U({type:n});static \u0275inj=T({imports:[X,W,P,L,te,ne,N,$,x,S,w]})};export{de as a};
